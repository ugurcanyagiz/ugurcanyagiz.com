---
const {
  filters = ["ALL"],
  cardSelector = ".science-card",
  defaultFilter = "ALL",
} = Astro.props;
---

<div class="filter-wrap" role="toolbar" aria-label="Filter content">
  {filters.map((f) => (
    <button class={`pill ${f === defaultFilter ? "active" : ""}`} type="button" data-filter={f}>
      {f}
    </button>
  ))}
</div>

<style>
  .filter-wrap{
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    padding: 10px 0 12px;
  }

  .pill{
    appearance: none;
    border: 1px solid rgba(0,0,0,0.10);
    background: rgba(255,255,255,0.85);
    color: rgba(11,11,15,0.70);
    border-radius: 999px;
    padding: 9px 12px;
    font-size: 12px;
    font-weight: 800;
    letter-spacing: .08em;
    text-transform: uppercase;
    cursor: pointer;
    transition: transform .15s ease, background .15s ease, color .15s ease;
    white-space: nowrap;
  }

  .pill:hover{
    transform: translateY(-1px);
    background: rgba(255,255,255,1);
    color: rgba(11,11,15,0.88);
  }

  .pill.active{
    background: rgba(11,11,15,0.90);
    color: rgba(255,255,255,0.94);
    border-color: rgba(11,11,15,0.12);
  }
</style>

<script is:inline define:vars={{ cardSelector, defaultFilter }}>
  const root = document.currentScript?.closest('.filter-wrap') || document;
  const pills = Array.from(root.querySelectorAll('.pill'));
  const cards = Array.from(document.querySelectorAll(cardSelector));

  function apply(filter){
    pills.forEach(p => p.classList.toggle('active', p.dataset.filter === filter));
    cards.forEach(card => {
      const cat = card.dataset.category;
      const show = (filter === 'ALL') || (cat === filter);
      card.classList.toggle('is-hidden', !show);
    });
  }

  pills.forEach(p => p.addEventListener('click', () => apply(p.dataset.filter)));
  apply(defaultFilter);
</script>
